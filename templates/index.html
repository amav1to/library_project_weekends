<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ - –í–∑—è—Ç—å –∫–Ω–∏–≥—É</title>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Bootstrap –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –≤–∏–¥–∞ -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        #student-suggestions {
            position: absolute;
            z-index: 1000;
            width: 100%;
            max-height: 200px;
            overflow-y: auto;
        }
        .list-group-item {
            cursor: pointer;
        }
        .list-group-item:hover {
            background-color: #f8f9fa;
        }

        #student-suggestions {
            position: absolute;
            z-index: 1000;
            width: 100%;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
        }
        #student-suggestions .list-group-item-light {
            font-weight: bold;
            font-size: 0.9em;
            padding: 0.5rem 1rem;
        }
        #student-suggestions .list-group-item-action {
            padding: 0.5rem 1rem;
            border: none;
            border-top: 1px solid rgba(0,0,0,.125);
            text-align: left;
        }
        #student-suggestions .list-group-item-action:hover {
            background-color: #0d6efd;
            color: white;
        }
    </style>

</head>
<body>
    <div class="container mt-5">
        <h1 class="mb-4">üìö –ó–∞—è–≤–∫–∞ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–Ω–∏–≥–∏</h1>
        
        <form method="POST" action="/request-book">
            <!-- –í—ã–±–æ—Ä –≥—Ä—É–ø–ø—ã -->
            <div class="mb-3">
                <label for="group" class="form-label">–í–∞—à–∞ –≥—Ä—É–ø–ø–∞:</label>
                <select class="form-select" id="group" name="group_id" required>
                    <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É --</option>
                    <!-- –°—é–¥–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –≥—Ä—É–ø–ø—ã —á–µ—Ä–µ–∑ Python -->
                </select>
            </div>

            <input type="hidden" id="current_group_id" name="current_group_id">

            <!-- –ü–æ–∏—Å–∫ —Å—Ç—É–¥–µ–Ω—Ç–∞ -->
            <div class="mb-3">
                <label for="student" class="form-label">–§–ò–û —Å—Ç—É–¥–µ–Ω—Ç–∞:</label>
                <div class="input-group">
                    <input type="text" class="form-control" id="student" 
                        placeholder="–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –§–ò–û..." 
                        autocomplete="off">
                    <button class="btn btn-outline-secondary" type="button" id="clear-student">
                        ‚úï
                    </button>
                </div>
                <!-- –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –¥–ª—è ID —Å—Ç—É–¥–µ–Ω—Ç–∞ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û–ï) -->
                <input type="hidden" name="student_id" id="student_id" required>
                <div class="form-text">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—É–¥–µ–Ω—Ç–∞ –∏–∑ —Å–ø–∏—Å–∫–∞</div>
                
                <div id="student-suggestions" class="list-group mt-2" style="display: none;">
                    <!-- –°—é–¥–∞ –±—É–¥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –ø–æ–¥—Å–∫–∞–∑–∫–∏ -->
                </div>
            </div>
            
            <!-- –í—ã–±–æ—Ä –∫–Ω–∏–≥–∏ -->
            <div class="mb-3">
                <label for="book" class="form-label">–ö–Ω–∏–≥–∞:</label>
                <select class="form-select" id="book" name="book_id" required>
                    <option value="">-- –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É --</option>
                    <!-- –ö–Ω–∏–≥–∏ –±—É–¥—É—Ç –ø–æ–¥–≥—Ä—É–∂–∞—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≥—Ä—É–ø–ø—ã -->
                </select>
            </div>
            
            <!-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ -->
            <div class="mb-3">
                <label for="quantity" class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤:</label>
                <input type="number" class="form-control" id="quantity" name="quantity" 
                    min="1" value="1" required style="max-width: 200px;">
                <div class="form-text">–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏</div>
            </div>
            
            <button type="submit" class="btn btn-primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å</button>
        </form>
        <!DOCTYPE html>
        <html lang="ru">
        <head>
            <!-- ... head content ... -->
        </head>
        <body>
            <div class="container mt-5">
                <h1 class="mb-4">üìö –ó–∞—è–≤–∫–∞ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–Ω–∏–≥–∏</h1>
                
                <form method="POST" action="/request-book">
                    <!-- ... –≤—Å—è —Ñ–æ—Ä–º–∞ ... -->
                </form>
                
                <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ -->
                <div class="modal fade" id="successModal" tabindex="-1" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-header bg-success text-white">
                                <h5 class="modal-title">
                                    <i class="bi bi-check-circle-fill"></i> –£—Å–ø–µ—à–Ω–æ!
                                </h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body text-center">
                                <div class="mb-3">
                                    <i class="bi bi-journal-check display-1 text-success"></i>
                                </div>
                                <h4 class="mb-3">–ó–∞–ø—Ä–æ—Å <span id="requestId" class="text-primary">#</span> –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω</h4>
                                <p class="lead">–û–∂–∏–¥–∞–π—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—è</p>
                                
                                <div class="alert alert-info">
                                    <i class="bi bi-info-circle"></i> 
                                    <strong>–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –Ω–æ–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞!</strong><br>
                                    –û–Ω –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                    <i class="bi bi-x-circle"></i> –ó–∞–∫—Ä—ã—Ç—å
                                </button>
                                <button type="button" class="btn btn-primary" id="checkStatusBtn">
                                    <i class="bi bi-search"></i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å" –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ -->
                <script>
                    document.getElementById('checkStatusBtn').addEventListener('click', function() {
                        // –ü—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –±–µ–∑ –Ω–æ–º–µ—Ä–∞
                        window.location.href = '/check-status';
                    });
                </script>

                <!-- –ü–æ—Å–ª–µ —Ñ–æ—Ä–º—ã, –ø–µ—Ä–µ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –æ–± –æ—à–∏–±–∫–∞—Ö -->
                <div class="card mt-4">
                    <div class="card-body">
                        <h5 class="card-title"><i class="bi bi-search"></i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–ø—Ä–æ—Å–∞</h5>
                        <p class="card-text">–£–∂–µ –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ –∑–∞–ø—Ä–æ—Å –∏ —Ö–æ—Ç–∏—Ç–µ —É–∑–Ω–∞—Ç—å –µ–≥–æ —Å—Ç–∞—Ç—É—Å?</p>
                        <a href="#" id="checkStatusBtn" class="btn btn-primary">
                            <i class="bi bi-search"></i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–ø—Ä–æ—Å–∞
                        </a>
                    </div>
                </div>

                <!-- === –î–û–ë–ê–í–ò–¢–¨ –≠–¢–û –ó–î–ï–°–¨ === -->
                <div id="error-message" class="alert alert-danger mt-3" style="display: none;"></div>
                <div id="success-message" class="alert alert-success mt-3" style="display: none;"></div>
                <!-- === –ö–û–ù–ï–¶ –î–û–ë–ê–í–õ–ï–ù–ò–Ø === -->
                
            </div> <!-- –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–π div –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ -->
            
            <!-- ... —Å–∫—Ä–∏–ø—Ç—ã ... -->

            <!-- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å" –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ -->
            <script>
                document.getElementById('checkStatusBtn').addEventListener('click', function() {
                    const requestIdElement = document.getElementById('requestId');
                    if (requestIdElement && requestIdElement.textContent) {
                        // –ü–æ–ª—É—á–∞–µ–º –Ω–æ–º–µ—Ä –≤–∏–¥–∞ "#071225-001"
                        const fullText = requestIdElement.textContent;
                        console.log('–¢–µ–∫—Å—Ç –Ω–æ–º–µ—Ä–∞:', fullText);
                        
                        // –ò–∑–≤–ª–µ–∫–∞–µ–º —á–∏—Å—Ç—ã–π –Ω–æ–º–µ—Ä
                        let requestId = fullText;
                        if (fullText.startsWith('#')) {
                            requestId = fullText.substring(1); // –£–±–∏—Ä–∞–µ–º #
                        }
                        
                        console.log('–ß–∏—Å—Ç—ã–π –Ω–æ–º–µ—Ä:', requestId);
                        window.location.href = '/check-status?request_id=' + encodeURIComponent(requestId);
                    } else {
                        // –ï—Å–ª–∏ –Ω–µ—Ç –Ω–æ–º–µ—Ä–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å
                        window.location.href = '/check-status?request_id=071225-001';
                    }
                });
            </script>
        </body>
        </html>
    </div>
    
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- –ù–∞—à JavaScript –¥–ª—è –ø–æ–∏—Å–∫–∞ -->
    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
</body>
</html>